(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     56751,       1269]
NotebookOptionsPosition[     56010,       1240]
NotebookOutlinePosition[     56347,       1255]
CellTagsIndexPosition[     56304,       1252]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700806727716104*^9, 3.7008067805048523`*^9}, 
   3.700892699972177*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"banana", "=", 
   RowBox[{
   "Import", "[", "\"\<//home/simone/Scrivania/MC/banana.png\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mela", "=", 
   RowBox[{
   "Import", "[", "\"\<//home/simone/Scrivania/MC/mela.png\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pera", "=", 
   RowBox[{
   "Import", "[", "\"\<//home/simone/Scrivania/MC/pera.png\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.700892744409169*^9, 3.7008927577770567`*^9}, {
  3.700893793889056*^9, 3.700893800339347*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pt1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "35"}], ",", "35"}], "}"}]}], ",", 
     RowBox[{"pt2", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "30"}], ",", "35"}], "}"}]}], ",", 
     RowBox[{"pt3", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.5"}], ",", "35"}], "}"}]}], ",", 
     RowBox[{"pt4", "=", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "35"}], "}"}]}], ",", 
     RowBox[{"pt5", "=", 
      RowBox[{"{", 
       RowBox[{"30", ",", "35"}], "}"}]}], ",", 
     RowBox[{"pt6", "=", 
      RowBox[{"{", 
       RowBox[{"35", ",", "35"}], "}"}]}], ",", " ", "eh1", ",", " ", "eh", 
     ",", " ", "eh2", ",", "l1", ",", "l2", ",", "l3", ",", "l4", ",", 
     RowBox[{"inPera", "=", "0"}], ",", 
     RowBox[{"inBanana", " ", "=", " ", "0"}], ",", 
     RowBox[{"inMela", "=", " ", "0"}], ",", 
     RowBox[{"oneTime", "=", "1"}], ",", 
     RowBox[{"oneTimeOut", "=", "1"}], ",", "prec"}], "}"}], ",", 
   RowBox[{"Dynamic", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"eh", "@", "pt1"}], ",", 
         RowBox[{"eh", "@", "pt2"}], ",", 
         RowBox[{"eh1", "@", "pt3"}], ",", 
         RowBox[{"eh1", "@", "pt4"}], ",", 
         RowBox[{"eh2", "@", "pt5"}], ",", 
         RowBox[{"eh2", "@", "pt6"}], ",", "Yellow", ",", 
         RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
         RowBox[{"l1", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "40"}], ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "35"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "25"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "20"}], ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "40"}], ",", "8"}], "}"}]}], "}"}], "]"}]}], ",", 
         "Red", ",", "\[IndentingNewLine]", 
         RowBox[{"l2", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "5"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"10", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "8"}], "}"}]}], "}"}], "]"}]}], ",", 
         "Green", ",", "\[IndentingNewLine]", 
         RowBox[{"l3", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"20", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"25", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"35", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"40", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"20", ",", "8"}], "}"}]}], "}"}], "]"}]}], ",", "Black",
          ",", 
         RowBox[{"Thickness", "[", "0.001", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"l4", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "44"}], ",", "0.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"44", ",", "0.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"44", ",", "40"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "44"}], ",", "40"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "44"}], ",", "0.2"}], "}"}]}], "}"}], "]"}]}], 
         ",", "Yellow", ",", 
         RowBox[{"FontSize", "\[Rule]", "20"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "40"}], ",", "2"}], "}"}]}], "]"}], ",", "Red", ",", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "2"}], "}"}]}], "]"}], ",", " ", 
         "Green", " ", ",", " ", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "900"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "45"}], ",", "45"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "40"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], ",", "None"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"testpoint", "[", 
        RowBox[{"poly_", ",", "pt_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "-", 
                   RowBox[{"RotateRight", "[", "#", "]"}]}], ")"}], "&"}], 
                "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ArcTan", "@@", 
                    RowBox[{"(", 
                    RowBox[{"pt", "-", "#"}], ")"}]}], "&"}], "/@", "poly"}], 
                 ")"}]}], ",", 
               RowBox[{"2", " ", "Pi"}], ",", 
               RowBox[{"-", "Pi"}]}], "]"}]}], "/", "2"}], "/", "Pi"}], ")"}],
          "]"}], "\[NotEqual]", "0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"eh1", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"eh", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"eh2", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"l1", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"l2", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"l3", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"l4", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"inPera", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"SetAttributes", "[", 
       RowBox[{"inBanana", ",", "HoldAll"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"oneTime", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"oneTimeOut", ",", "HoldAll"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"prec", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eh1", "[", "val1_", "]"}], ":=", 
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Inset", "[", 
           RowBox[{"mela", ",", 
            RowBox[{"Dynamic", "@", "val1"}], ",", "Automatic", ",", "5"}], 
           "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"val1", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], ")"}]}], ",", 
           RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"inMela", " ", "==", " ", "0"}], " ", "&&", " ", 
                 RowBox[{"oneTimeOut", "\[Equal]", "1"}]}], " ", ",", 
                RowBox[{
                 RowBox[{"val1", "=", 
                  RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                 ";"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", " ", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "\[Equal]", "0"}], ",", 
                   RowBox[{"oneTimeOut", "=", "1"}]}], "]"}], ";", " ", 
                 RowBox[{"inMela", "=", "1"}], ";"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "se", " ", "la", " ", "mela", " ", "viene", " ", "messa", " ", 
                
                RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                "contenitore", " ", "delle", " ", "mele"}], "*)"}], 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
                   RowBox[{"-", "5"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "10"}]}], 
                 " ", ",", 
                 RowBox[{
                  RowBox[{"inMela", "=", "1"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"oneTime", "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"oneTime", "=", "0"}], ";", 
                    RowBox[{"Speak", "[", "\"\<Very good!\>\"", "]"}], 
                    ";"}]}], "]"}], ";"}], ",", 
                 RowBox[{
                  RowBox[{"inMela", "=", "0"}], ";", 
                  RowBox[{"oneTime", "=", " ", "1"}]}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "se", " ", "la", " ", "mela", " ", "viene", " ", "messa", " ", 
                 RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                 "contenitore", " ", "banana"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
                   RowBox[{"-", "35"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"-", "20"}]}]}], " ", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "==", "1"}], ",", 
                   RowBox[{
                    RowBox[{"val1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "15"}], "}"}]}], ";", 
                    RowBox[{"oneTimeOut", "=", "0"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Speak", "[", "\"\<Very Bad!\>\"", "]"}], ";"}], 
                   "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "se", " ", "la", " ", "mela", " ", "viene", " ", "messa", " ", 
                 RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                 "contenitore", " ", "pera"}], "*)"}], "\[IndentingNewLine]", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", "25"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "40"}]}], 
                 " ", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "==", "1"}], ",", 
                   RowBox[{
                    RowBox[{"val1", "=", 
                    RowBox[{"{", 
                    RowBox[{"30", ",", "15"}], "}"}]}], ";", 
                    RowBox[{"oneTimeOut", "=", "0"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Speak", "[", "\"\<Very Bad!\>\"", "]"}], ";"}], 
                   "*)"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
             ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eh", "[", "val_", "]"}], ":=", 
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Inset", "[", 
           RowBox[{"banana", ",", 
            RowBox[{"Dynamic", "@", "val"}], ",", "Automatic", ",", "5"}], 
           "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"val", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], ")"}]}], ",", 
           RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"inBanana", " ", "==", " ", "0"}], " ", "&&", " ", 
                 RowBox[{"oneTimeOut", "\[Equal]", "1"}]}], ",", 
                RowBox[{"val", "=", 
                 RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"If", "[", " ", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "\[Equal]", "0"}], ",", 
                   RowBox[{"oneTimeOut", "=", "1"}]}], "]"}], ";", " ", 
                 RowBox[{"inBanana", "=", "1"}], ";"}]}], "]"}], ";", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
                   RowBox[{"-", "35"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"-", "20"}]}]}], " ", ",", 
                 RowBox[{
                  RowBox[{"inBanana", "=", "1"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"oneTime", "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"oneTime", "=", "0"}], ";", 
                    RowBox[{"Speak", "[", "\"\<Very good!\>\"", "]"}], 
                    ";"}]}], "]"}], ";"}], ",", 
                 RowBox[{
                  RowBox[{"inBanana", "=", "0"}], ";", 
                  RowBox[{"oneTime", "=", " ", "1"}]}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "se", " ", "la", " ", "banana", " ", "viene", " ", "messa", 
                 " ", 
                 RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                 "contenitore", " ", "mela"}], "*)"}], "\[IndentingNewLine]", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
                   RowBox[{"-", "5"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "10"}]}], 
                 " ", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "==", "1"}], ",", 
                   RowBox[{
                    RowBox[{"val", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "15"}], "}"}]}], ";", 
                    RowBox[{"oneTimeOut", "=", "0"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Speak", "[", "\"\<Very Bad!\>\"", "]"}], ";"}], 
                   "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "se", " ", "la", " ", "banana", " ", "viene", " ", "messa", 
                 " ", 
                 RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                 "contenitore", " ", "pera"}], "*)"}], "\[IndentingNewLine]", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", "25"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "40"}]}], 
                 " ", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "==", "1"}], ",", 
                   RowBox[{
                    RowBox[{"val", "=", 
                    RowBox[{"{", 
                    RowBox[{"30", ",", "15"}], "}"}]}], ";", 
                    RowBox[{"oneTimeOut", "=", "0"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Speak", "[", "\"\<Very Bad!\>\"", "]"}], ";"}], 
                   "*)"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eh2", "[", "val2_", "]"}], ":=", 
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Inset", "[", 
           RowBox[{"pera", ",", 
            RowBox[{"Dynamic", "@", "val2"}], ",", "Automatic", ",", "5"}], 
           "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"val2", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], ")"}]}], ",", 
           RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"inPera", " ", "==", " ", "0"}], " ", "&&", " ", 
                 RowBox[{"oneTimeOut", "\[Equal]", "1"}]}], ",", 
                RowBox[{"val2", "=", 
                 RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"If", "[", " ", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "\[Equal]", "0"}], ",", 
                   RowBox[{"oneTimeOut", "=", "1"}]}], "]"}], ";", " ", 
                 RowBox[{"inPera", "=", "1"}], ";"}]}], "]"}], ";", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", "25"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "40"}]}], 
                 " ", ",", 
                 RowBox[{
                  RowBox[{"inPera", "=", "1"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"oneTime", "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"oneTime", "=", "0"}], ";", 
                    RowBox[{"Speak", "[", "\"\<Very good!\>\"", "]"}], 
                    ";"}]}], "]"}], ";"}], ",", 
                 RowBox[{
                  RowBox[{"inPera", "=", "0"}], ";", 
                  RowBox[{"oneTime", "=", " ", "1"}]}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "se", " ", "la", " ", "pera", " ", "viene", " ", "messa", " ", 
                 RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                 "contenitore", " ", "mela"}], "*)"}], "\[IndentingNewLine]", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
                   RowBox[{"-", "5"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "10"}]}], 
                 " ", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "==", "1"}], ",", 
                   RowBox[{
                    RowBox[{"val2", "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "15"}], "}"}]}], ";", 
                    RowBox[{"oneTimeOut", "=", "0"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Speak", "[", "\"\<Very Bad!\>\"", "]"}], ";"}], 
                   "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "se", " ", "la", " ", "pera", " ", "viene", " ", "messa", " ", 
                 RowBox[{"all", "'"}], "interno", " ", "del", " ", 
                 "contenitore", " ", "banana"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "5"}], " ",
                   "&&", " ", 
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
                   RowBox[{"-", "35"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"val2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"-", "20"}]}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"oneTimeOut", "==", "1"}], ",", 
                   RowBox[{
                    RowBox[{"val2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "15"}], "}"}]}], ";", 
                    RowBox[{"oneTimeOut", "=", "0"}]}]}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Speak", "[", "\"\<Very Bad!\>\"", "]"}], ";"}], 
                   "*)"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "}"}]}],
         "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7008077417445107`*^9, 3.700807741745123*^9}, {
   3.700807838765872*^9, 3.700807838912586*^9}, {3.7008079591033*^9, 
   3.7008080191211987`*^9}, {3.7008080872138977`*^9, 
   3.7008080892653933`*^9}, {3.700808130196567*^9, 3.70080813120857*^9}, {
   3.70080818399844*^9, 3.700808186515027*^9}, {3.7008082553543463`*^9, 
   3.7008082862402678`*^9}, {3.7008083358398533`*^9, 
   3.7008083370912647`*^9}, {3.700808411594194*^9, 3.700808422489992*^9}, {
   3.700808489464603*^9, 3.700808506584937*^9}, {3.700808556859991*^9, 
   3.7008085810972233`*^9}, {3.700808615246131*^9, 3.7008086611169777`*^9}, {
   3.700808707592641*^9, 3.7008087365717793`*^9}, {3.7008096250677156`*^9, 
   3.700809627252096*^9}, {3.700809773354067*^9, 3.7008098267602367`*^9}, {
   3.700810274388131*^9, 3.700810277335327*^9}, {3.700892227040637*^9, 
   3.700892314416314*^9}, {3.7008924615253153`*^9, 3.7008924742488203`*^9}, {
   3.700892531815757*^9, 3.700892539773512*^9}, {3.700892764079619*^9, 
   3.7008930314190063`*^9}, {3.7008932213570967`*^9, 
   3.7008933041980867`*^9}, {3.700893366661886*^9, 3.700893465236712*^9}, {
   3.700893589447455*^9, 3.700893590807169*^9}, {3.700893657115323*^9, 
   3.700893789762216*^9}, 3.700893994134356*^9, {3.7008957306636333`*^9, 
   3.700895747085877*^9}, {3.7008957852892942`*^9, 3.700895806250677*^9}, {
   3.700895838228518*^9, 3.700895860365547*^9}, {3.700896084834257*^9, 
   3.700896159774329*^9}, {3.7008966392751217`*^9, 3.700896652724106*^9}, {
   3.7008967956286583`*^9, 3.700896798014309*^9}, {3.7008968301795607`*^9, 
   3.700896832392214*^9}, {3.700897007135611*^9, 3.7008970095141582`*^9}, {
   3.7008970517765503`*^9, 3.700897239592094*^9}, {3.7008973238834267`*^9, 
   3.7008973385932293`*^9}, {3.700897529374345*^9, 3.700897720384179*^9}, {
   3.700897751481152*^9, 3.700897872208633*^9}, {3.700897908499358*^9, 
   3.700897908605997*^9}, {3.70097283148092*^9, 3.700972834750309*^9}, {
   3.700972955922813*^9, 3.700972964018156*^9}, {3.700973045798778*^9, 
   3.700973048450358*^9}, {3.700973346400854*^9, 3.7009733669685707`*^9}, {
   3.700973804205845*^9, 3.7009738070795927`*^9}, {3.700973877577448*^9, 
   3.70097387787327*^9}, {3.700973908377947*^9, 3.700973977367571*^9}, {
   3.700974031328792*^9, 3.700974086281561*^9}, {3.700974132345941*^9, 
   3.700974136072249*^9}, {3.7009742058602457`*^9, 3.700974215675527*^9}, {
   3.700974330066267*^9, 3.700974346500126*^9}, {3.7009744350090647`*^9, 
   3.700974469483016*^9}, {3.700974679734975*^9, 3.700974718662125*^9}, {
   3.7009750196175947`*^9, 3.700975044077738*^9}, {3.700975186153743*^9, 
   3.700975189708539*^9}, 3.7009753062391853`*^9, {3.700975427340156*^9, 
   3.700975736901557*^9}, {3.7009758827390537`*^9, 3.7009758924720383`*^9}, {
   3.700976021568886*^9, 3.7009760332714977`*^9}, {3.7009761070497704`*^9, 
   3.700976226847372*^9}, {3.7009763380830107`*^9, 3.700976348590521*^9}, 
   3.700976388555324*^9, {3.700976472517455*^9, 3.700976483484652*^9}, {
   3.700977007333222*^9, 3.7009770261490173`*^9}, {3.70097706832526*^9, 
   3.700977071575293*^9}, {3.700977176971283*^9, 3.7009771932066593`*^9}, {
   3.700977258928853*^9, 3.700977267132468*^9}, {3.7009774508815603`*^9, 
   3.700977570383132*^9}, {3.70097761798343*^9, 3.700977638794773*^9}, {
   3.700977821706274*^9, 3.700977858727339*^9}, {3.700977968177354*^9, 
   3.7009780305933237`*^9}, {3.700978107178502*^9, 3.7009781172151747`*^9}, {
   3.700979011838835*^9, 3.700979067823058*^9}, {3.7009792181220827`*^9, 
   3.700979252271867*^9}, {3.700979282910627*^9, 3.700979295114911*^9}, {
   3.700979371264435*^9, 3.700979373545671*^9}, {3.7009795356006927`*^9, 
   3.7009795737970657`*^9}, {3.700979720921774*^9, 3.7009797397661667`*^9}, 
   3.700980191688936*^9, 3.7009802402921543`*^9, {3.700980559226239*^9, 
   3.700980589385684*^9}, {3.700980688812112*^9, 3.700980750052094*^9}, {
   3.700980791573316*^9, 3.700980792512035*^9}, {3.7009808699770184`*^9, 
   3.700980877272772*^9}, {3.7009809649844017`*^9, 3.700980966169774*^9}, {
   3.700981094693357*^9, 3.700981109648652*^9}, {3.70098115640282*^9, 
   3.700981158444209*^9}, {3.7009812649750338`*^9, 3.700981266299925*^9}, {
   3.70098141558181*^9, 3.7009814495254803`*^9}, {3.700981698928282*^9, 
   3.7009817064831953`*^9}, {3.7009825252798233`*^9, 3.700982550600752*^9}, {
   3.700982582372085*^9, 3.700982597862059*^9}, {3.700982655951136*^9, 
   3.7009826560517807`*^9}, {3.700982741816168*^9, 3.7009827756447077`*^9}, 
   3.700982918503953*^9, {3.700983034391728*^9, 3.700983041095009*^9}, {
   3.700983108890325*^9, 3.700983164820393*^9}, {3.700983255575981*^9, 
   3.700983256746841*^9}, {3.700983293649858*^9, 3.700983484141255*^9}, {
   3.700983530170327*^9, 3.700983530911571*^9}, {3.7009835788421593`*^9, 
   3.7009835926216707`*^9}, {3.700983638779224*^9, 3.700983643068602*^9}, {
   3.700983683611156*^9, 3.700983830897038*^9}, {3.700983928935793*^9, 
   3.700984005217826*^9}, {3.700984100000134*^9, 3.700984159139423*^9}, {
   3.70098419794643*^9, 3.700984365362873*^9}, {3.700984415195969*^9, 
   3.700984420869866*^9}, 3.701015050277532*^9, {3.701015257312582*^9, 
   3.701015286217284*^9}, {3.7010153278080063`*^9, 3.701015359836973*^9}}],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`pt1$$ = {-35, 35}, $CellContext`pt2$$ = {-30, 
  35}, $CellContext`pt3$$ = {-3.0999999999999943`, 
  34.7}, $CellContext`pt4$$ = {3.200000000000003, 
  34.8}, $CellContext`pt5$$ = {30, 35}, $CellContext`pt6$$ = {34.5, 
  35.1}, $CellContext`eh1$$, $CellContext`eh$$, $CellContext`eh2$$, \
$CellContext`l1$$ = 
  Line[{{-40, 8}, {-35, 1}, {-25, 1}, {-20, 8}, {-40, 
   8}}], $CellContext`l2$$ = 
  Line[{{-10, 8}, {-5, 1}, {5, 1}, {10, 8}, {-10, 8}}], $CellContext`l3$$ = 
  Line[{{20, 8}, {25, 1}, {35, 1}, {40, 8}, {20, 8}}], $CellContext`l4$$ = 
  Line[{{-44, 0.2}, {44, 0.2}, {44, 40}, {-44, 
    40}, {-44, 0.2}}], $CellContext`inPera$$ = 0, $CellContext`inBanana$$ = 
  0, $CellContext`inMela$$ = 0, $CellContext`oneTime$$ = 
  1, $CellContext`oneTimeOut$$ = 1, $CellContext`prec$$}, 
  DynamicBox[ToBoxes[
    Graphics[{
      $CellContext`eh$$[$CellContext`pt1$$], 
      $CellContext`eh$$[$CellContext`pt2$$], 
      $CellContext`eh1$$[$CellContext`pt3$$], 
      $CellContext`eh1$$[$CellContext`pt4$$], 
      $CellContext`eh2$$[$CellContext`pt5$$], 
      $CellContext`eh2$$[$CellContext`pt6$$], Yellow, 
      Thickness[0.01], $CellContext`l1$$ = 
      Line[{{-40, 8}, {-35, 1}, {-25, 1}, {-20, 8}, {-40, 8}}], 
      Red, $CellContext`l2$$ = 
      Line[{{-10, 8}, {-5, 1}, {5, 1}, {10, 8}, {-10, 8}}], 
      Green, $CellContext`l3$$ = 
      Line[{{20, 8}, {25, 1}, {35, 1}, {40, 8}, {20, 8}}], Black, 
      Thickness[0.001], $CellContext`l4$$ = 
      Line[{{-44, 0.2}, {44, 0.2}, {44, 40}, {-44, 40}, {-44, 0.2}}], Yellow, 
      FontSize -> 20, 
      Text["A", {-40, 2}], Red, 
      Text["B", {-10, 2}], Green, 
      Text["C", {20, 2}]}, ImageSize -> 900, 
     PlotRange -> {{-45, 45}, {0, 40}}, Axes -> False], StandardForm], None,
   ImageSizeCache->{900., {197., 203.}}],
  DynamicModuleValues:>{{DownValues[$CellContext`eh1$$] = {HoldPattern[
         $CellContext`eh1$$[
          Pattern[$CellContext`val1$, 
           Blank[]]]] :> EventHandler[{
          Inset[$CellContext`mela, 
           Dynamic[$CellContext`val1$], Automatic, 5]}, {
         "MouseClicked" :> ($CellContext`val1$ = {1, 1}), 
          "MouseDragged" :> (If[
             
             And[$CellContext`inMela$$ == 0, $CellContext`oneTimeOut$$ == 
              1], $CellContext`val1$ = MousePosition["Graphics"]; Null, 
             If[$CellContext`oneTimeOut$$ == 0, $CellContext`oneTimeOut$$ = 
               1]; $CellContext`inMela$$ = 1; Null]; If[
              And[
              Part[$CellContext`val1$, 2] < 5, 
               Part[$CellContext`val1$, 1] > -5, Part[$CellContext`val1$, 1] < 
               10], $CellContext`inMela$$ = 1; 
              If[$CellContext`oneTime$$ == 1, $CellContext`oneTime$$ = 0; 
                Speak["Very good!"]; Null]; 
              Null, $CellContext`inMela$$ = 0; $CellContext`oneTime$$ = 1] 
            If[
              And[
              Part[$CellContext`val1$, 2] < 5, 
               Part[$CellContext`val1$, 1] > -35, 
               Part[$CellContext`val1$, 1] < -20], 
              
              If[$CellContext`oneTimeOut$$ == 
               1, $CellContext`val1$ = {-30, 15}; $CellContext`oneTimeOut$$ = 
                0]] If[
              And[
              Part[$CellContext`val1$, 2] < 5, Part[$CellContext`val1$, 1] > 
               25, Part[$CellContext`val1$, 1] < 40], 
              
              If[$CellContext`oneTimeOut$$ == 
               1, $CellContext`val1$ = {30, 15}; $CellContext`oneTimeOut$$ = 
                0]])}]}, Attributes[$CellContext`eh1$$] = {HoldAll}}, {
    DownValues[$CellContext`eh$$] = {HoldPattern[
         $CellContext`eh$$[
          Pattern[$CellContext`val$, 
           Blank[]]]] :> EventHandler[{
          Inset[$CellContext`banana, 
           Dynamic[$CellContext`val$], Automatic, 5]}, {
         "MouseClicked" :> ($CellContext`val$ = {1, 1}), "MouseDragged" :> (If[
             
             And[$CellContext`inBanana$$ == 0, $CellContext`oneTimeOut$$ == 
              1], $CellContext`val$ = MousePosition["Graphics"], 
             If[$CellContext`oneTimeOut$$ == 0, $CellContext`oneTimeOut$$ = 
               1]; $CellContext`inBanana$$ = 1; Null]; If[
              And[
              Part[$CellContext`val$, 2] < 5, 
               Part[$CellContext`val$, 1] > -35, 
               Part[$CellContext`val$, 1] < -20], $CellContext`inBanana$$ = 1; 
              If[$CellContext`oneTime$$ == 1, $CellContext`oneTime$$ = 0; 
                Speak["Very good!"]; Null]; 
              Null, $CellContext`inBanana$$ = 0; $CellContext`oneTime$$ = 1] 
            If[
              And[
              Part[$CellContext`val$, 2] < 5, Part[$CellContext`val$, 1] > -5,
                Part[$CellContext`val$, 1] < 10], 
              
              If[$CellContext`oneTimeOut$$ == 
               1, $CellContext`val$ = {0, 15}; $CellContext`oneTimeOut$$ = 0]]
              If[
              And[
              Part[$CellContext`val$, 2] < 5, Part[$CellContext`val$, 1] > 25,
                Part[$CellContext`val$, 1] < 40], 
              
              If[$CellContext`oneTimeOut$$ == 
               1, $CellContext`val$ = {30, 15}; $CellContext`oneTimeOut$$ = 
                0]])}]}, Attributes[$CellContext`eh$$] = {HoldAll}}, {
    DownValues[$CellContext`eh2$$] = {HoldPattern[
         $CellContext`eh2$$[
          Pattern[$CellContext`val2$, 
           Blank[]]]] :> EventHandler[{
          Inset[$CellContext`pera, 
           Dynamic[$CellContext`val2$], Automatic, 5]}, {
         "MouseClicked" :> ($CellContext`val2$ = {1, 1}), 
          "MouseDragged" :> (If[
             
             And[$CellContext`inPera$$ == 0, $CellContext`oneTimeOut$$ == 
              1], $CellContext`val2$ = MousePosition["Graphics"], 
             If[$CellContext`oneTimeOut$$ == 0, $CellContext`oneTimeOut$$ = 
               1]; $CellContext`inPera$$ = 1; Null]; If[
              And[
              Part[$CellContext`val2$, 2] < 5, Part[$CellContext`val2$, 1] > 
               25, Part[$CellContext`val2$, 1] < 40], $CellContext`inPera$$ = 
               1; If[$CellContext`oneTime$$ == 1, $CellContext`oneTime$$ = 0; 
                Speak["Very good!"]; Null]; 
              Null, $CellContext`inPera$$ = 0; $CellContext`oneTime$$ = 1] 
            If[
              And[
              Part[$CellContext`val2$, 2] < 5, 
               Part[$CellContext`val2$, 1] > -5, Part[$CellContext`val2$, 1] < 
               10], 
              
              If[$CellContext`oneTimeOut$$ == 
               1, $CellContext`val2$ = {0, 15}; $CellContext`oneTimeOut$$ = 
                0]] If[
              And[
              Part[$CellContext`val2$, 2] < 5, 
               Part[$CellContext`val2$, 1] > -35, 
               Part[$CellContext`val2$, 1] < -20], 
              
              If[$CellContext`oneTimeOut$$ == 
               1, $CellContext`val2$ = {-30, 15}; $CellContext`oneTimeOut$$ = 
                0]])}]}, Attributes[$CellContext`eh2$$] = {HoldAll}}, {
    Attributes[$CellContext`l1$$] = {HoldAll}}, {
    Attributes[$CellContext`l2$$] = {HoldAll}}, {
    Attributes[$CellContext`l3$$] = {HoldAll}}, {
    Attributes[$CellContext`l4$$] = {HoldAll}}, {
    Attributes[$CellContext`inPera$$] = {HoldAll}}, {
    Attributes[$CellContext`inBanana$$] = {HoldAll}}, {
    Attributes[$CellContext`oneTime$$] = {HoldAll}}, {
    Attributes[$CellContext`oneTimeOut$$] = {HoldAll}}, {
    Attributes[$CellContext`prec$$] = {HoldAll}}},
  Initialization:>($CellContext`testpoint[
      Pattern[$CellContext`poly, 
       Blank[]], 
      Pattern[$CellContext`pt, 
       Blank[]]] := Round[(Total[
          Mod[
           (# - RotateRight[#]& )[
            Map[Apply[ArcTan, $CellContext`pt - #]& , $CellContext`poly]], 2 
           Pi, -Pi]]/2)/Pi] != 0; SetAttributes[$CellContext`eh1$$, HoldAll]; 
   SetAttributes[$CellContext`eh$$, HoldAll]; 
   SetAttributes[$CellContext`eh2$$, HoldAll]; 
   SetAttributes[$CellContext`l1$$, HoldAll]; 
   SetAttributes[$CellContext`l2$$, HoldAll]; 
   SetAttributes[$CellContext`l3$$, HoldAll]; 
   SetAttributes[$CellContext`l4$$, HoldAll]; 
   SetAttributes[$CellContext`inPera$$, HoldAll]; 
   SetAttributes[$CellContext`inBanana$$, HoldAll]; 
   SetAttributes[$CellContext`oneTime$$, HoldAll]; 
   SetAttributes[$CellContext`oneTimeOut$$, HoldAll]; 
   SetAttributes[$CellContext`prec$$, HoldAll]; $CellContext`eh1$$[
      Pattern[$CellContext`val1$, 
       Blank[]]] := EventHandler[{
       Inset[$CellContext`mela, 
        Dynamic[$CellContext`val1$], Automatic, 5]}, {
      "MouseClicked" :> ($CellContext`val1$ = {1, 1}), "MouseDragged" :> (If[
          
          And[$CellContext`inMela$$ == 0, $CellContext`oneTimeOut$$ == 
           1], $CellContext`val1$ = MousePosition["Graphics"]; Null, 
          If[$CellContext`oneTimeOut$$ == 0, $CellContext`oneTimeOut$$ = 
            1]; $CellContext`inMela$$ = 1; Null]; If[
           And[
           Part[$CellContext`val1$, 2] < 5, Part[$CellContext`val1$, 1] > -5, 
            Part[$CellContext`val1$, 1] < 10], $CellContext`inMela$$ = 1; 
           If[$CellContext`oneTime$$ == 1, $CellContext`oneTime$$ = 0; 
             Speak["Very good!"]; Null]; 
           Null, $CellContext`inMela$$ = 0; $CellContext`oneTime$$ = 1] If[
           And[
           Part[$CellContext`val1$, 2] < 5, Part[$CellContext`val1$, 1] > -35,
             Part[$CellContext`val1$, 1] < -20], 
           
           If[$CellContext`oneTimeOut$$ == 
            1, $CellContext`val1$ = {-30, 15}; $CellContext`oneTimeOut$$ = 0]]
           If[
           And[
           Part[$CellContext`val1$, 2] < 5, Part[$CellContext`val1$, 1] > 25, 
            Part[$CellContext`val1$, 1] < 40], 
           
           If[$CellContext`oneTimeOut$$ == 
            1, $CellContext`val1$ = {30, 15}; $CellContext`oneTimeOut$$ = 
             0]])}]; $CellContext`eh$$[
      Pattern[$CellContext`val$, 
       Blank[]]] := EventHandler[{
       Inset[$CellContext`banana, 
        Dynamic[$CellContext`val$], Automatic, 5]}, {
      "MouseClicked" :> ($CellContext`val$ = {1, 1}), "MouseDragged" :> (If[
          
          And[$CellContext`inBanana$$ == 0, $CellContext`oneTimeOut$$ == 
           1], $CellContext`val$ = MousePosition["Graphics"], 
          If[$CellContext`oneTimeOut$$ == 0, $CellContext`oneTimeOut$$ = 
            1]; $CellContext`inBanana$$ = 1; Null]; If[
           And[
           Part[$CellContext`val$, 2] < 5, Part[$CellContext`val$, 1] > -35, 
            Part[$CellContext`val$, 1] < -20], $CellContext`inBanana$$ = 1; 
           If[$CellContext`oneTime$$ == 1, $CellContext`oneTime$$ = 0; 
             Speak["Very good!"]; Null]; 
           Null, $CellContext`inBanana$$ = 0; $CellContext`oneTime$$ = 1] If[
           And[
           Part[$CellContext`val$, 2] < 5, Part[$CellContext`val$, 1] > -5, 
            Part[$CellContext`val$, 1] < 10], 
           
           If[$CellContext`oneTimeOut$$ == 
            1, $CellContext`val$ = {0, 15}; $CellContext`oneTimeOut$$ = 0]] If[
           And[
           Part[$CellContext`val$, 2] < 5, Part[$CellContext`val$, 1] > 25, 
            Part[$CellContext`val$, 1] < 40], 
           
           If[$CellContext`oneTimeOut$$ == 
            1, $CellContext`val$ = {30, 15}; $CellContext`oneTimeOut$$ = 
             0]])}]; $CellContext`eh2$$[
      Pattern[$CellContext`val2$, 
       Blank[]]] := EventHandler[{
       Inset[$CellContext`pera, 
        Dynamic[$CellContext`val2$], Automatic, 5]}, {
      "MouseClicked" :> ($CellContext`val2$ = {1, 1}), "MouseDragged" :> (If[
          
          And[$CellContext`inPera$$ == 0, $CellContext`oneTimeOut$$ == 
           1], $CellContext`val2$ = MousePosition["Graphics"], 
          If[$CellContext`oneTimeOut$$ == 0, $CellContext`oneTimeOut$$ = 
            1]; $CellContext`inPera$$ = 1; Null]; If[
           And[
           Part[$CellContext`val2$, 2] < 5, Part[$CellContext`val2$, 1] > 25, 
            Part[$CellContext`val2$, 1] < 40], $CellContext`inPera$$ = 1; 
           If[$CellContext`oneTime$$ == 1, $CellContext`oneTime$$ = 0; 
             Speak["Very good!"]; Null]; 
           Null, $CellContext`inPera$$ = 0; $CellContext`oneTime$$ = 1] If[
           And[
           Part[$CellContext`val2$, 2] < 5, Part[$CellContext`val2$, 1] > -5, 
            Part[$CellContext`val2$, 1] < 10], 
           
           If[$CellContext`oneTimeOut$$ == 
            1, $CellContext`val2$ = {0, 15}; $CellContext`oneTimeOut$$ = 0]] 
         If[
           And[
           Part[$CellContext`val2$, 2] < 5, Part[$CellContext`val2$, 1] > -35,
             Part[$CellContext`val2$, 1] < -20], 
           
           If[$CellContext`oneTimeOut$$ == 
            1, $CellContext`val2$ = {-30, 15}; $CellContext`oneTimeOut$$ = 
             0]])}]; Null)]], "Output",
 CellChangeTimes->{{3.700808240859068*^9, 3.700808290752317*^9}, 
   3.700808339470256*^9, 3.7008084247038383`*^9, 3.70080849634334*^9, {
   3.700808563072648*^9, 3.700808584038291*^9}, {3.700808634447032*^9, 
   3.7008086633644867`*^9}, 3.7008087497213097`*^9, 3.700809630214712*^9, {
   3.700809795861113*^9, 3.700809828668416*^9}, {3.700810261592443*^9, 
   3.700810280020549*^9}, 3.700812986020678*^9, 3.700891966511085*^9, 
   3.700892339109087*^9, 3.7008924769926*^9, 3.70089254193316*^9, {
   3.700892777109445*^9, 3.700892806728402*^9}, 3.700892901011023*^9, {
   3.7008930092042227`*^9, 3.700893033570017*^9}, {3.7008932232661963`*^9, 
   3.7008932762680483`*^9}, 3.700893310645027*^9, 3.7008933685178747`*^9, {
   3.700893423740251*^9, 3.700893438532138*^9}, 3.700893805971689*^9, 
   3.7008939961591387`*^9, 3.7008958170975533`*^9, 3.700895863147781*^9, {
   3.7008961078674803`*^9, 3.700896163790215*^9}, {3.7008966446191874`*^9, 
   3.700896658379674*^9}, 3.700896800802681*^9, 3.700896834562374*^9, 
   3.700897011536511*^9, {3.700897141828396*^9, 3.7008971604418097`*^9}, 
   3.70089719915543*^9, 3.7008972703641033`*^9, 3.700897341384424*^9, {
   3.70089738558144*^9, 3.700897412008562*^9}, 3.700897450035734*^9, {
   3.700897551852054*^9, 3.700897569642208*^9}, {3.700897651902945*^9, 
   3.700897722471004*^9}, {3.70089775583216*^9, 3.7008978746461277`*^9}, 
   3.700897910917103*^9, 3.70097283823383*^9, 3.7009730507595873`*^9, 
   3.700973912826096*^9, 3.700973948097102*^9, 3.700973979895713*^9, 
   3.700974316780463*^9, {3.700974452824658*^9, 3.700974471987698*^9}, {
   3.700974693609652*^9, 3.700974737955799*^9}, 3.700975046959996*^9, {
   3.700975314151853*^9, 3.700975319817857*^9}, {3.700975602809669*^9, 
   3.7009756651212473`*^9}, 3.700975742212936*^9, 3.700975786325315*^9, 
   3.700975899367491*^9, {3.700976035206148*^9, 3.700976079326682*^9}, {
   3.700976215836605*^9, 3.700976231100358*^9}, 3.700976263419734*^9, 
   3.7009763517901382`*^9, {3.700976474519863*^9, 3.700976485846271*^9}, 
   3.70097707720895*^9, 3.700977195048477*^9, 3.700977269884552*^9, 
   3.700977575348806*^9, 3.700977640654852*^9, 3.700977997108535*^9, 
   3.700978032697527*^9, 3.700979041461204*^9, 3.700979106027421*^9, 
   3.7009792990137377`*^9, 3.70097938011664*^9, {3.700979416788892*^9, 
   3.700979427450794*^9}, 3.700979698508263*^9, {3.700980263567645*^9, 
   3.700980274903541*^9}, {3.700980600386397*^9, 3.700980622634809*^9}, 
   3.700980754209906*^9, 3.7009807981993027`*^9, 3.700980881250016*^9, 
   3.700980973814211*^9, {3.7009811364643917`*^9, 3.700981162790753*^9}, 
   3.700981271515087*^9, {3.70098147190409*^9, 3.700981495320064*^9}, {
   3.700981712031495*^9, 3.700981722224807*^9}, {3.7009825385203876`*^9, 
   3.70098255432691*^9}, 3.7009826014729652`*^9, 3.700982659630672*^9, 
   3.700982926007677*^9, 3.700982973958786*^9, 3.700983078266762*^9, 
   3.700983168178441*^9, 3.700983261129574*^9, {3.700983317033366*^9, 
   3.7009833373881617`*^9}, 3.7009833833637047`*^9, {3.700983471374392*^9, 
   3.700983486979287*^9}, 3.700983537438002*^9, 3.700983597469234*^9, 
   3.7009836542409267`*^9, 3.7009837547978973`*^9, 3.700983832968608*^9, 
   3.700983882063651*^9, 3.70098393415665*^9, {3.700983985444756*^9, 
   3.7009840093743353`*^9}, {3.700984147937294*^9, 3.700984162985342*^9}, {
   3.700984206130773*^9, 3.700984234510735*^9}, 3.700984270439783*^9, 
   3.700984321512344*^9, {3.70098435634454*^9, 3.700984370494755*^9}, 
   3.7009844270794*^9, 3.7010148549993763`*^9, 3.7010149425646973`*^9, 
   3.701014997422637*^9, {3.701015069730089*^9, 3.701015085426477*^9}, 
   3.701015227335318*^9, {3.7010152612914867`*^9, 3.7010153021997538`*^9}, {
   3.7010153390298653`*^9, 3.7010153622216*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"Rest", "@", "pts"}]}], ",", 
       RowBox[{"pt", "=", 
        RowBox[{"First", "@", "pts"}]}]}], "}"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"testpoint", "[", 
            RowBox[{"p", ",", "pt"}], "]"}], ",", "Pink", ",", "Orange"}], 
          "]"}], ",", 
         RowBox[{"Polygon", "@", "p"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"3", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"400", ",", "475"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Text", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"testpoint", "[", 
              RowBox[{"p", ",", "pt"}], "]"}], ",", "\"\<True \>\"", ",", 
             "\"\<False\>\""}], "]"}], ",", "Bold", ",", "Italic"}], "]"}], 
         "]"}]}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"(", 
       RowBox[{"3", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ")"}]}], ",", "Locator",
      ",", 
     RowBox[{"LocatorAutoCreate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"4", ",", "Infinity"}], "}"}]}]}], "}"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "test", " ", "if", " ", "point", " ", "pt", " ", "inside", " ", 
       "polygon", " ", "poly"}], "*)"}], 
     RowBox[{
      RowBox[{"testpoint", "[", 
       RowBox[{"poly_", ",", "pt_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Round", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "-", 
                  RowBox[{"RotateRight", "[", "#", "]"}]}], ")"}], "&"}], "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ArcTan", "@@", 
                   RowBox[{"(", 
                    RowBox[{"pt", "-", "#"}], ")"}]}], "&"}], "/@", "poly"}], 
                ")"}]}], ",", 
              RowBox[{"2", " ", "Pi"}], ",", 
              RowBox[{"-", "Pi"}]}], "]"}]}], "/", "2"}], "/", "Pi"}], ")"}], 
        "]"}], "\[NotEqual]", "0"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.700898549117054*^9, 3.700898574283495*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pts$$ = {{0, 0}, {-2, -2}, {2, -2}, {0, 2}},
     Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pts$$], {{0, 0}, {-2, -2}, {2, -2}, {0, 
       2}}}, {-3, -3}, {3, 3}}}, Typeset`size$$ = {400., {234., 241.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`pts$989$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`pts$$ = {{0, 0}, {-2, -2}, {2, -2}, {0, 
         2}}}, "ControllerVariables" :> {
        Hold[$CellContext`pts$$, $CellContext`pts$989$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      With[{$CellContext`p = Rest[$CellContext`pts$$], $CellContext`pt = 
         First[$CellContext`pts$$]}, 
        Graphics[{
          If[
           $CellContext`testpoint[$CellContext`p, $CellContext`pt], Pink, 
           Orange], 
          Polygon[$CellContext`p]}, PlotRange -> 3 {{-1, 1}, {-1, 1}}, 
         ImageSize -> {400, 475}, PlotLabel -> Text[
           Style[
            If[
             $CellContext`testpoint[$CellContext`p, $CellContext`pt], "True ",
              "False"], Bold, Italic]]]], 
      "Specifications" :> {{{$CellContext`pts$$, {{0, 0}, {-2, -2}, {2, -2}, {
          0, 2}}}, {-3, -3}, {3, 3}, ControlType -> Locator, 
         LocatorAutoCreate -> {4, 
           DirectedInfinity[1]}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{453., {268., 275.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({{$CellContext`testpoint[
           Pattern[$CellContext`poly, 
            Blank[]], 
           Pattern[$CellContext`pt, 
            Blank[]]] := Round[Total[
              Mod[
               (# - RotateRight[#]& )[
                Map[Apply[ArcTan, $CellContext`pt - #]& , $CellContext`poly]],
                2 Pi, -Pi]] 2^(-1)/Pi] != 0}; {$CellContext`testpoint[
           Pattern[$CellContext`poly, 
            Blank[]], 
           Pattern[$CellContext`pt, 
            Blank[]]] := Round[(Total[
               Mod[
                (# - RotateRight[#]& )[
                 Map[
                 Apply[ArcTan, $CellContext`pt - #]& , $CellContext`poly]], 2 
                Pi, -Pi]]/2)/Pi] != 0}}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7008985757376757`*^9, 3.701014855286435*^9}]
}, Open  ]],

Cell["", "Text"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700971623570177*^9, 3.700971625197043*^9}}],

Cell[CellGroupData[{

Cell["CONCETTO", "Subtitle",
 CellFrame->6,
 CellChangeTimes->{{3.700971633393548*^9, 3.700971654164226*^9}, {
  3.70097175503893*^9, 3.700971801315381*^9}},
 TextAlignment->Center],

Cell["prova pro", "Text",
 CellChangeTimes->{{3.700973519857327*^9, 3.70097353275412*^9}, {
  3.700977143015222*^9, 3.70097714431185*^9}}],

Cell["", "Text"]
}, Open  ]]
},
WindowSize->{1366, 704},
WindowMargins->{{-10, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 120, 2, 32, "Input"],
Cell[681, 24, 584, 17, 77, "Input"],
Cell[CellGroupData[{
Cell[1290, 45, 30687, 676, 1683, "Input"],
Cell[31980, 723, 16620, 312, 415, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48637, 1040, 3724, 109, 165, "Input"],
Cell[52364, 1151, 3138, 66, 560, "Output"]
}, Open  ]],
Cell[55517, 1220, 16, 0, 33, "Text"],
Cell[55536, 1222, 92, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[55653, 1227, 181, 4, 79, "Subtitle"],
Cell[55837, 1233, 138, 2, 33, "Text"],
Cell[55978, 1237, 16, 0, 33, "Text"]
}, Open  ]]
}
]
*)

